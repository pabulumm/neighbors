<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8/>
    {% load staticfiles %}
    <title>Neighbors</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no'/>
    <script src='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
{#    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>#}
    <script type="text/javascript" src="{% static 'budget/chart.js' %}"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          crossorigin="anonymous">
    <link href='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.css' rel='stylesheet'/>
    {# <link href='https://www.mapbox.com/base/latest/base.css' rel='stylesheet' /> #}
    <link rel="stylesheet" type="text/css" href="{% static 'neighborhood/css/style.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'neighborhood/css/map_home.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'neighborhood/css/status.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'neighborhood/css/report.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'neighborhood/css/feed.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'accounts/css/profile.css' %}"/>
    <script type="text/javascript" src="{% static 'neighborhood/js/get_icon.js' %}"></script>
    {#        <script type="text/javascript" src="{% static 'neighborhood/js/style.js' %}"></script>#}
    <script type="text/javascript" src="{% static 'markers/js/markers.js' %}"></script>
    <script type="text/javascript" src="{% static 'neighborhood/js/feed.js' %}"></script>
    <script type="text/javascript" src="{% static 'neighborhood/js/csrf.js' %}"></script>
    <script type="text/javascript" src="{% static 'neighborhood/js/colors.js' %}"></script>
</head>
<body>

<div id="top-strip">
    <a id="list-menu-button" href="#">
        <span id="menu-icon" title="Navigation Menu"
              class='glyphicon glyphicon-list'></span>
    </a>
    <h1 class="white-text">Neighbors</h1>
    <div class="icons">
        {#        <a id="account-button" class='btn btn-default btn-circle btn-lg' href="#">#}
        {#            <span class='glyphicon glyphicon-user'></span>#}
        {#        </a>#}
        <a id="list-button" class='btn btn-default btn-circle btn-lg'
           title="Help" href="{% url 'neighborhood:index' %}">
            <span id="help-button" class='glyphicon glyphicon-question-sign'></span>
        </a>
        {#        <a id="report" class='btn btn-default btn-circle btn-lg'>#}
        {#            <span class='glyphicon glyphicon-alert'></span>#}
        {#        </a>#}
    </div>
</div>

<div id="report-container">
    <a id="cancel" class="btn btn-circle"><span class="glyphicon glyphicon-remove"></span></a>
    <div class='report'>
        <form action="{% url 'neighborhood:home' %}" method="POST">
            {% csrf_token %}
            {{ report_form.as_p }}
            {#            <button id="close-report" class="btn btn-default">Close</button>#}
            <button id="submit-report" class="btn btn-default">Submit</button>
        </form>
    </div>
</div>

<div id="content" class="content">


    {#-------------------- MAIN NAV SLIDE OUT WINDOW ----------------------------#}
    <div id="list-menu">
        <div style="height:80px"></div>
        <small class="menu-section-title">The Buzz</small>
        <span class="divider"></span>
        <button id="home-select" class="menu-option">Home</button>
        <button id="poll-select" class="menu-option">Decisions</button>
        <button id="announce-index">Announcements</button>

        <small class="menu-section-title">My Neighborhood</small>
        <span class="divider"></span>

        <button id="info-select" class="menu-option">Information</button>
        <button id="event-select">Event Calendar</button>

        <small class="menu-section-title">My House</small>
        <span class="divider"></span>


        <button id="account-select" class="menu-option">Profile</button>
        <a style="text-decoration:none;" href="{% url 'accounts:user_logout' %}">
            <button>Logout</button>
        </a>
    </div>


    {#==============================================================================#}
    {#------------------------------- HOME PAGE ------------------------------------#}
    {#==============================================================================#}


    {#-----------------------MAP MAIN WINDOW---------------------------#}
    <div id="map-container" class="main">
        <p id="new-marker-info">Click anywhere on the map to place the marker.</p>
        <div id='map' class='streets'>
        </div>
    </div>

    {#-----------------------FEED SIDE BAR (WITH MAP) ---------------------------#}
    <div id="feed" class="sidebar">
        {#        <span class="side-title-span"></span>#}
        <div id="feed-header">
            <p id="feed-title" class="side-window-title">The Feed</p>
            <button id="refresh-feed" onclick="location.reload();" title="Refresh Feed">
                <span class="glyphicon glyphicon-refresh"></span>
            </button>
            <form action="javascript:submitPost()" method="POST">
                <div id="user-post">
                    {#            need a feed post form so user can submit post from home-page #}
                    <textarea title="Post Text" id="post-text" placeholder="Start sharing."></textarea>
                    <button id="marker-post-button" class="post-button" title="Add Location Marker">
                        <span class="glyphicon glyphicon-map-marker"></span>
                    </button>
                    <button id="submit-post" type="submit" class="post-button" title="Submit Post">
                        SUBMIT
                    </button>
                </div>
            </form>
        </div>
        <div id="feed-header-toggle">
            <button id="toggle-user-post">
                <span id="toggle-post-icon" class="glyphicon glyphicon-menu-up"></span>
            </button>
        </div>
        <div id="feed-post-container">
            {% for post in feedposts %}
                <div id="feed-post{{ post.id }}" class="feed-item">
                    {#                                                        <div class="flag"><p>!</p></div>#}
                    <script>
                        newPostId({{ post.id }});
{#                        checkPostViewed({{ post.id }});#}
                        addPostBanner({{ post.id }}, "{{ post.type }}");
                    </script>
                    <div class="feed-item-body">
                        {% if post.type == 'POST-NORMAL' %}
                            <script>getUserImage('#feed-post{{ post.id }}');</script>
                            <small>
                                <strong style="font-size:16px">{{ post.user.first_name }} {{ post.user.last_name }}</strong>
                            </small>
                            <small> on {{ post.create_date }}</small>
                            <p id="text">{{ post.text }}</p>
                        {% elif post.type == 'POST-MARKER' or post.type == 'MARKER' %}
                            <script>getUserImage('#feed-post{{ post.id }}');</script>
                            <small>
                                <strong style="font-size:16px">{{ post.user.first_name }} {{ post.user.last_name }}</strong>
                            </small>
                            <small> on {{ post.create_date }}</small>
                            <script>
                                createMarkerFeedPost(
                                        "{{ post.marker.type_of_marker }}", {{ post.id }}, "{{ post.text }}", {{ post.marker.id }}, {{ post.marker.lat }}, {{ post.marker.lon }});
                            </script>
                        {% elif post.type == 'ANNOUNCEMENT' %}
                            <p class="poll-post-text">{{ post.text }}</p>
                            <small class="feed-post-name">
                                <strong>{{ post.user.first_name }} {{ post.user.last_name }}</strong>
                            </small>
                            <small class="post-date"> on {{ post.create_date }}</small>
                        {% elif post.type == 'POLL' %}
                            <a class="poll-link"><p class="poll-post-text">{{ post.text }}</p></a>
                            <button id="{{ post.decision.id }}" class="vote-confirm">Yes</button>
                            <button id="{{ post.decision.id }}" class="vote-deny">No</button>
                            <small class="feed-post-name">
                                <strong>{{ post.user.first_name }} {{ post.user.last_name }}</strong>
                            </small>
                            <small> on {{ post.create_date }}</small>
                        {% endif %}
                        <script>
                            $("#feed-post{{ post.id }}").click(function () {
                                $('#flag{{ post.id }}').hide();
                            });
                        </script>
                    </div>
                </div>
            {% endfor %}
        </div>

    </div>


    {#==============================================================================#}
    {#------------------------------- DECISIONS ------------------------------------#}
    {#==============================================================================#}

    {#-----------------------POLLS MAIN WINDOW ---------------------------#}
    <div id="poll-main" class="main">
        <h1 id="poll-title" class="section-title">{{ neighborhood.division_title }} Decisions</h1>
        <button id="new-poll-button" class="add-content-button" type="button"
                data-toggle="modal" data-target="#newPollModal">
            <span class="glyphicon glyphicon-plus"></span>
        </button>
        <div id="poll-container" class="section-container">
            {% if polls %}
                {% for poll in polls %}
                    <div class="poll-item-container">
                        <div class="poll-item-header">
                            <div class="poll-status">
                                {% if poll.status == 'PENDING' %}
                                    <span class="glyphicon glyphicon-time"></span>
                                {% elif poll.status == 'CONFIRMED' %}
                                    <span style="background: rgba(162,241,212,1)"
                                          class="glyphicon glyphicon-thumbs-up"></span>
                                {% elif poll.status == 'DENIED' %}
                                    <span style="background: rgba(221,146,147,1)"
                                          class="glyphicon glyphicon-thumbs-down"></span>
                                {% endif %}
                            </div>
                            <script>newPollId({{ poll.id }})</script>
                            <h1>{{ poll.question_text }}</h1>
                            <small>{{ poll.pub_date }}</small>
                            <div class="vote-count">
                                <span class="glyphicon glyphicon-thumbs-up"></span>
                                <label>14   </label>
                                <span class="glyphicon glyphicon-thumbs-down"></span>
                                <label>3</label>
                            </div>
                        </div>
                        <div class="poll-item-body">
                            <p>{{ poll.description }}</p>

                            <button id="{{ poll.id }}" class="vote-button">Yes</button>
                            <button id="{{ poll.id }}" style="background: #c94e50" class="vote-button">No</button>
                        </div>

                    </div>

                {% endfor %}
            {% else %}
                <p>Your neighborhood has not yet made any decisions!</p>
            {% endif %}
        </div>

{#---------------------------------POLL MODAL ----------------------------------#}
        <div class="container">
            <!-- Modal -->
            <div class="modal fade" id="newPollModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <form id="new-poll-form" method="post" action="{% url 'polls:new' %}">
                            {% csrf_token %}
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">New Decision</h4>
                            </div>
                            <div class="modal-body">
                                {{ pollform.as_p }}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>

    </div>


    {#----------------------- POLLS MENU SIDE BAR ---------------------------#}
    <div id="poll-sidebar" class="sidebar">
        <span class="separator"></span>
        <h1 class="sidebar-tag">
            <span class="emphasize">Our</span> neighborhood.<br/>
            <span class="emphasize">Our</span> choices.<br/>
            <span class="emphasize">Our</span> way.</h1>
    </div>


    {#==============================================================================#}
    {#------------------------------- ANNOUNCEMENTS --------------------------------#}
    {#==============================================================================#}

    {#-----------------------ANNOUNCEMENTS MAIN WINDOW ---------------------------#}
    <div id="announcement-main" class="main">
        <h1 id="announcement-title" class="section-title"> {{ neighborhood.division_title }} Announcements</h1>

        <div id="announcement-container" class="section-container">
            {% if feedposts %}
                {% for post in feedposts %}
                    <div class="announcement-item-container">
                        <div class="announcement-item">
                            <h1>{{ post.title }}</h1>
                            <small>{{ post.create_date }}</small>
                            <p id="description">{{ post.description }}</p>
                            <small><strong>{{ post.user }}</strong></small>
                        </div>
                    </div>

                {% endfor %}
            {% else %}
                <p>No announcements to show you!</p>
            {% endif %}
        </div>
    </div>


    {#----------------------- ANNOUNCEMENTS MENU SIDE BAR ---------------------------#}
    <div id="announcement-sidebar" class="sidebar">
        <span class="separator"></span>
        <h1 class="sidebar-tag">
            <span class="emphasize">Our</span> perspective.<br/>
            <span class="emphasize">Our</span> business.<br/>
            <span class="emphasize">Our</span> way.</h1>
    </div>


    {#==============================================================================#}
    {#-------------------------------------- PROFILE -------------------------------#}
    {#==============================================================================#}

    {#-----------------------ACCOUNT MAIN WINDOW---------------------------#}
    <div id="account" class="main">
        <div class="container">
            <div id="profile-pic">
                <img src="{% static 'markers/png/user-alt-256.png' %}"/>
            </div>
            {% if board_permissions == True %}

            {% endif %}
            <p id="account-name">{{ request.user.first_name }} {{ request.user.last_name }}</p>
            <button id="announcement" type="button" class="btn btn-info btn-lg"
                    data-toggle="modal" data-target="#myModal">
                Make Announcement
            </button>

            <div id="account-menu">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#profile">Profile</a></li>
                    <li><a href="#activity">Activity</a></li>
                    <li><a href="#messages">messages</a></li>
                    <li><a href="#settings">Settings</a></li>
                </ul>

                <div class="tab-content">
                    <div id="profile" class="tab-pane fade in active">
                        <p>Neighborhood: {{ user.house.neighborhood.division_title }}</p>
                        <p>Family Name: {{ user.family_name }}</p>
                        <p>Join Date: {{ user.join_date }}</p>
                        <p>Address: {{ user.address }}</p>
                    </div>
                    <div id="activity" class="tab-pane fade">
                        <p>This is the ACTIVITY tab.</p>
                    </div>
                    <div id="messages" class="tab-pane fade">
                        <p>This is the MESSAGES tab.</p>
                    </div>
                    <div id="settings" class="tab-pane fade">
                        <p>This is the SETTINGS tab.</p>
                    </div>
                </div> <!-- end tab-content -->
            </div>

            <div class="container">
                <!-- Modal -->
                <div class="modal fade" id="myModal" role="dialog">
                    <div class="modal-dialog">

                        <!-- Modal content-->
                        <div class="modal-content">
                            <form method="post" action="{% url 'feed:announce' %}">
                                {% csrf_token %}
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">New Announcement</h4>
                                </div>
                                <div class="modal-body">
                                    {{ announcement_form.as_p }}
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                </div>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>


    {#-----------------------ACCOUNT SIDE BAR---------------------------#}
    <div id="account-options" class="sidebar">
        <p id="account-title" class="side-window-title">Profile</p>
        <div id="map-account-container">
            <div id='map2'></div>
        </div>
        <div class="holder">
            <a class="btn btn-primary" href="#">Edit Profile</a><br/>
            <a class="btn btn-primary" href="#">Make Announcement</a><br/>
            {#            <button id="announcement" type="button" class="btn btn-info btn-lg"#}
            {#                    data-toggle="modal" data-target="#myModal">#}
            {#                Make Announcement#}
            {#            </button>#}
            <a class="btn btn-primary" href="#">Report Incident</a><br/>
            <a class="btn btn-primary" href="#">Neighbors List</a><br/>
        </div>
    </div>


    {#==============================================================================#}
    {#------------------------------- EVENT CALENDAR -------------------------------#}
    {#==============================================================================#}

    {#----------------------- EVENT CALENDAR MAIN WINDOW ---------------------------#}
    <div id="event-calendar" class="main">
        <div id="calendar-head">
            <p id="event-section-title" class="section-title">{{ neighborhood.division_title }} Events</p>

            {#            <button id="calendar-month-prev" class="btn btn-default">#}
            {#                <span id="left-arrow" class="glyphicon glyphicon-chevron-left"></span>#}
            {#            </button>#}
            {#            <button id="calendar-month-next" class="btn btn-default">#}
            {#                <span id="right-arrow" class="glyphicon glyphicon-chevron-right"></span>#}
            {#            </button>#}
        </div>
        <div id="calendar-body"></div>


{#---------------------------------EVENT MODAL ----------------------------------#}

        <div class="container">
            <!-- Modal -->
            <div class="modal fade" id="newEventModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <form id="new-event-form" method="post" action="{% url 'neighborhood:new-event' %}">
                            {% csrf_token %}
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">New Event</h4>
                            </div>
                            <div class="modal-body">
                                {{ eventform.as_p }}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>

    >

    {#----------------------- EVENT DETAIL SIDE BAR --------------------------------#}
    <div id="event-detail" class="sidebar">
        <div id="event-box">
            <div id="event-map-container">
                <div id='map3'></div>
            </div>
            <h1 id="event-title">Event Title</h1>
            <small id="time" class="time"></small>
            <small id="location" class="time">Location:</small>
            <p id="description"></p>
            <div id="event-list-day">

            </div>
            <button id="new-event-button" class="add-content-button" type="button"
                    data-toggle="modal" data-target="#newEventModal">
                <span class="glyphicon glyphicon-plus"></span>
            </button>
        </div>
    </div>






    {#==============================================================================#}
    {#------------------------------- NEIGHBORHOOD INFO ----------------------------#}
    {#==============================================================================#}

    <div id="info-main" class="main">

        {#        <div id="info-tab-container">#}
        <div class="tab-content">
            <div id="about" class="tab-pane fade in active">
                <p class="section-title">About our {{ neighborhood.division_title }}</p>
            </div>
            <div id="budget-tab" class="tab-pane fade">
                <p class="section-title">{{ neighborhood.division_title }} Budget</p>
                <div id="piechart"></div>
{#                <div id="linechart"></div>#}
            </div>
            <div id="ccr" class="tab-pane fade">
                <p class="section-title">{{ neighborhood.division_title }} Covenants, Conditions & Restrictions.</p>
                <p id="ccr-info">
                </p>
            </div>
            <div id="board" class="tab-pane fade">
                <p class="section-title">{{ neighborhood.division_title }} Board Members</p>
            </div>
        </div>
        {#        </div>#}
    </div>


    <div id="info-sidebar" class="sidebar">
        <div id="info-nav-container">
            <ul class="nav nav-pills nav-stacked">
                <li class="active info-section-link"><a href="#about">About</a></li>
                <li class="info-section-link"><a href="#budget-tab">Budget</a></li>
                <li class="info-section-link"><a href="#ccr">CC&Rs</a></li>
                <li class="info-section-link"><a href="#board">Board Members</a></li>
            </ul>
        </div>
    </div>


</div>


<script type="text/javascript" src="{% static 'neighborhood/js/mapscript.js' %}"></script>
<script type="text/javascript" src="{% static 'neighborhood/js/report.js' %}"></script>
<script type="text/javascript" src="{% static 'neighborhood/js/page_swap.js' %}"></script>
<script type="text/javascript" src="{% static 'neighborhood/js/polls.js' %}"></script>
<script>
    centerUserMap({{ user.house.lat }}, {{ user.house.lon }})</script>
{#<script>#}
{#    centerUserMap([34.220912, -119.055079])#}
{#</script>#}
<script type="text/javascript" src="{% static 'neighborhood/js/events.js' %}"></script>

{#<script>showMap();</script>#}
</body>
</html>